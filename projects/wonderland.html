<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wonderland ‚Äì TryHackMe Walkthrough</title>

  <!-- GH Pages repo k√∂k√º -->
  <base href="/my-website/">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Senin stiller + tema -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="assets/theme.css">
  <meta name="color-scheme" content="light dark" />

  <!-- Highlight.js: light + dark temalar (otomatik ge√ßi≈ü) -->
  <link id="hljs-light" rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer">
  <link id="hljs-dark" rel="stylesheet" disabled
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer">

  <!-- Tema toggle + dinamik navbar -->
  <script defer src="assets/theme.js"></script>
  <script defer src="assets/navbar.js"></script>

  <!-- Kod bloklarƒ± i√ßin ufak stil (temaya duyarlƒ± arka plan) -->
  <style>
    pre{margin-bottom:1.5rem;border-radius:.5rem;overflow-x:auto;padding:1rem;background:#f6f8fa}
    pre code{font-family:SFMono-Regular,Menlo,Consolas,"Courier New",monospace;font-size:.9rem;line-height:1.4}
    :root[data-theme="dark"] pre{ background:#0f141b; }
  </style>

  <!-- HLJS temasƒ±nƒ± data-theme'e g√∂re e≈üle -->
  <script>
    (function(){
      const root = document.documentElement;
      const light = document.getElementById('hljs-light');
      const dark  = document.getElementById('hljs-dark');
      function sync(){
        const isDark = root.getAttribute('data-theme') === 'dark';
        light.disabled = isDark;
        dark.disabled  = !isDark;
      }
      // ƒ∞lk y√ºklemede ve tema deƒüi≈üince uygula
      new MutationObserver(sync).observe(root, { attributes:true, attributeFilter:['data-theme'] });
      document.addEventListener('DOMContentLoaded', sync);
    })();
  </script>
</head>

<body class="bg-gray-50 text-gray-800 font-sans min-h-screen flex flex-col">
  <!-- Navbar Hook -->
  <div id="site-nav"></div>

  <main class="flex-grow flex justify-center px-4 py-10">
    <article class="w-full max-w-4xl bg-white shadow-lg rounded-2xl p-8 space-y-10">
      <!-- Header -->
      <header class="space-y-4">
        <h2 class="text-3xl font-bold text-gray-900"> Wonderland ‚Äì TryHackMe CTF Walkthrough</h2>
        <p class="text-gray-700 leading-relaxed">This CTF room takes you down the rabbit hole ‚Äî literally. Inspired by Alice in Wonderland, it‚Äôs a whimsical blend of puzzles, enumeration, privilege escalation, and unexpected surprises hiding behind every corner. This CTF challenge took my 2.5 hours but thanks to this Walkthrough it will take less for you guys.
        </p>
        <p class="text-sm text-gray-500"><strong>‚ö†Ô∏è Disclaimer:</strong> SPOILER ALERT!</p>
      </header>

      <!-- 1. Nmap -->
      <section id="nmap" class="space-y-4">
        <h3 class="text-2xl font-semibold">1Ô∏è‚É£ Nmap Scan ‚Äì Initial Enumeration</h3>
        <img src="../assets/images/wonderland_nmap.png" alt="Nmap scan results" class="rounded shadow w-full" />
        <p class="text-gray-700">
            The first step in the Wonderland CTF was to run an Nmap scan against the target machine. Using nmap -sV, we discovered that ports 22 (SSH) and 80 (HTTP) were open. This suggested that we could expect an SSH login opportunity later and that the HTTP service might reveal something interesting upon inspection.
        </p>
<pre><code class="language-bash">nmap -sV 10.10.X.X -oN</code></pre>
      </section>

      <!-- 2. Dirb -->
      <section id="gobuster" class="space-y-4">
        <h3 class="text-2xl font-semibold">2Ô∏è‚É£ Gobuster ‚Äì Web Content Discovery</h3>
        <img src="../assets/images/wonderland_dirb_1.png" alt="Dirb results" class="rounded shadow w-full" />
        <img src="../assets/images/wonderland_dirb_2.png" alt="Dirb results" class="rounded shadow w-full" />
        <p class="text-gray-700">
            Once we identified that port 80 was open, we navigated to the website and began a typical web enumeration phase. Using dirb, we brute-forced directory paths and successfully discovered a hidden folder: /r. This directory contained what appeared to be an ordinary image file.
            While our initial progress came from brute-forcing (no stego magic needed), this is also where steganography could have been applied.
<pre><code class="language-bash">dirb http://10.10.53.217:80/r/a</code></pre>
      </section>

        <!-- Bonus: Steganography Attempt (/img Directory)-->
      <section id="gobuster" class="space-y-4">
        <h3 class="text-2xl font-semibold"> ‚ûï Bonus: Steganography Attempt (/img Directory)</h3>
        <img src="../assets/images/wonderland_steogra.png" alt="Dirb results" class="rounded shadow w-full" />
        <p class="text-gray-700">
            Though not essential for solving the room, we explored steganography just in case. We found white_rabbit_1.jpg inside the /img directory and analyzed it using tools like exiftool, strings, steghide, zsteg, and binwalk.
            These efforts helped us practice identifying hidden data inside image files ‚Äî a valuable skill in many CTFs. While the real password was ultimately guessed and brute-forced via directory enumeration, this optional exploration served as a good example of thinking outside the box when needed.
      </section>

      <!-- 3. r/a/b/b/i/t and SSH Connection -->
      <section id="burp" class="space-y-4">
        <h3 class="text-2xl font-semibold">3Ô∏è‚É£ 3. r/a/b/b/i/t and SSH Connection</h3>
        <img src="../assets/images/wonderland_ssh_password.png" alt="BurpSuite Intruder fuzz" class="rounded shadow w-full" />
        <p class="text-gray-700">
            Inside the r/a/b/b/i/t directory, we checked the page source and spotted something interesting: a reference to alice. It wasn‚Äôt super obvious, but enough to raise an eyebrow.
            That little hint made us wonder ‚Äî could alice be a real user on the system? We took a chance and tried connecting over SSH as alice.
            
        </p>
      </section>

      <!-- SSH Alice Privilege Escalation -->
      <section id="reverse-shell" class="space-y-4">
        <h3 class="text-2xl font-semibold">4Ô∏è‚É£ SSH Alice Privilege Escalation</h3>
        <img src="../assets/images/wonderland_alice_1.png" alt="privesc" class="rounded shadow w-full" />
        <p class="text-gray-700">
            Once inside as Alice, we found ourselves in her home directory. Two files stood out: root.txt (of course, permission denied üôÉ) and a suspicious Python file named walrus_and_the_carpenter.py.
            Being the curious pentesters we are, we peeked into its permissions and discovered that Alice was allowed to run it as Rabbit using sudo. üé© That‚Äôs a big win.
            
            To test our theory, we created a quick Python script that simply spawns a bash shell:wonderland_alice_2.png
        </p>
        <img src="../assets/images/wonderland_alice_2.png" alt="Reverse shell screenshot" class="rounded shadow w-full" />

      </section>

      <!-- 5. PrivEsc -->
      <section id="privesc" class="space-y-4">
        <h3 class="text-2xl font-semibold">5Ô∏è‚É£ SSH Rabbit Privilege Escalation</h3>
        <img src="../assets/images/wonderland_rabbit_1.png" alt="Privilege escalation screenshot" class="rounded shadow w-full" />
        <p class="text-gray-700">
            After becoming the user rabbit, we took a look around and immediately spotted something odd in their home directory‚Äîa suspiciously named binary: teaParty. The name alone sounded like it held secrets, and the file permissions confirmed it: the binary had the SUID bit set, meaning it could potentially run with elevated (root) privileges. üëÄOn execution, it simply said:

            "Welcome to the tea party!
            The Mad Hatter will be here soon..."

        </p>
        <img src="../assets/images/wonderland_rabbit_2.png" alt="Privilege escalation screenshot" class="rounded shadow w-full" />
        <p class="text-gray-700 mt-4">Wait, what? Hatter? Sounds like some sort of callback to earlier users. ü§î That gave us a hunch: maybe the binary calls external programs‚Äîand if so, we could hijack one of them.
            To test this, we created a malicious script in /tmp named date (a common Linux command), filled it with a simple #!/bin/bash reverse shell, made it executable, and then manipulated our $PATH to prioritize /tmp.
        </p>

        <img src="../assets/images/wonderland_rabbit_3.png" alt="Privilege escalation screenshot" class="rounded shadow w-full" />
        <Then class="text-gray-700 mt-4" > Then we ran ./teaParty again‚Ä¶ and boom. üí• Root shell.
        We weren‚Äôt just at the tea party anymore‚Äîwe were hosting it. üéâ
        From here, it was just a matter of cat /root/root.txt, and the final flag was ours.
        </p>
      </section>
      
      
      <!-- 6. PrivEsc -->
      <section id="privesc" class="space-y-4">
        <h3 class="text-2xl font-semibold">6Ô∏è‚É£ SSH Hatter and Flags</h3>
        <img src="../assets/images/wonderland_hatter_1.png" alt="Privilege escalation screenshot" class="rounded shadow w-full" />
        <p class="text-gray-700">
            Once inside Hatter‚Äôs home directory, we found a single file: password.txt. Opening it revealed another curious phrase: WhyIsARavenLikeAWritingDesk? ‚Äî likely password for hatter (or just a philosophical crisis). üê¶üìù

        </p>
        <img src="../assets/images/wonderland_hatter_2.png" alt="Privilege escalation screenshot" class="rounded shadow w-full" />
        <p class="text-gray-700 mt-4">We now had access to much more of the system ‚Äî but not everything. Attempts to list or access the /root directory or alice's root.txt were denied. Still, one flag ‚Äî user.txt ‚Äî was readable and gave us:
            thm{Curiouser and curiouser!} üí°
            
        </p>
        <img src="../assets/images/wonderland_hatter_3.png" alt="Privilege escalation screenshot" class="rounded shadow w-full" />
        <Then class="text-gray-700 mt-4" > Just when it seemed like we were stuck as Hatter ‚Äî no sudo rights, no access to Alice‚Äôs or root‚Äôs secret flags ‚Äî we stumbled upon a hidden ace up our sleeve: Perl. üé≠
            Turns out the system allowed us to execute /usr/bin/perl with elevated privileges. Using a simple one-liner that leveraged Perl‚Äôs POSIX module, we invoked setuid(0) and launched a root shell. Just like that, we were root. üëë
            
            No rabbits, no riddles ‚Äî just pure SUID magic and a dash of scripting wizardry. With root access in hand, we finally read the second flag in Alice‚Äôs home:
            thm{Twinkle, twinkle, little bat! How I wonder what you're at!}
        </p>
      </section>



    </article>
  </main>

  <!-- Highlight.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-I5fHnn9SxkFpHVeq2xkA7C4c3AlEeakBSQE0x3EJOiq0kileBg/jYvNvA/KCQURkWv68mpz2qc
